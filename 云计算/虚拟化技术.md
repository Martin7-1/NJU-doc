# 虚拟化技术

## 基本概念

**虚拟化是云计算的核心技术，但不是其专用技术**

本质：虚拟化的本质就是通过添加一个虚拟化层将原先的物理设备进行逻辑化，转换成一个文件夹或文件，实现软硬件的解耦。核心思想是利用软件或固件管理程序构成虚拟化层，把无力资源映射为虚拟资源。在虚拟资源上可以安装和部署多个虚拟机，实现多用户共享物理资源。

“虚拟化技术”的两种理解方式：抽象 vs. 拆分

![虚拟化技术的两种理解方式](https://img-bed-1309306776.cos.ap-shanghai.myqcloud.com/img/20220928141258.png)

> 虚拟化技术成就了云计算，硬件的快速发展成就了虚拟化

### 计算机系统的虚拟化

![计算机系统的各个抽象层](https://img-bed-1309306776.cos.ap-shanghai.myqcloud.com/img/20220928141602.png)

由位于下层的软件模块，通过向上一层软件模块提供一个与它原先所期待的运行环境完全一致的接口的方法，抽象出一个虚拟的软件或硬件接口，使得上层软件可以直接运行在虚拟的环境上。

一些概念：

1. 宿主：被虚拟化的对象
2. 宿主机：被虚拟化的对象设备
3. 宿主机操作系统：被虚拟化的对象设备的操作系统
4. 客户：在虚拟层上安装的对象
5. 客户机：在虚拟层上安装的对象设备
6. 客户机操作系统：在虚拟层上安装的操作系统

## 服务器虚拟化层级

![服务器虚拟化的层级](https://img-bed-1309306776.cos.ap-shanghai.myqcloud.com/img/20220928144326.png)

![服务器虚拟化技术的发展及代表产品](https://img-bed-1309306776.cos.ap-shanghai.myqcloud.com/img/20220928144302.png)

**代表产品**

1. VMware：技术 + 公司，1999年推出虚拟化产品；从虚拟化技术转向云产品
   * VMware vSphere：安装在裸机的强大服务器，可以在其上同时运行多台虚拟机
   * VMware Workstation：是在 Windows 或 Linux 操作系统上运行的应用程序，可以模拟 x86 标准PC环境。可以安装操作系统
2. Xen：由剑桥大学开发的开源虚拟机监视器。需要对操作系统进行显式的修改才能运行
3. KVM：Kernel-based Virtual Machine
4. LXC：Linux Container
5. Docker

### 硬件级虚拟化

添加一个称为虚拟化层的软件，管理客户操作系统，使其能够独立于主机操作系统同时运行在一个硬件上

* Hypervisor
* Virtual Machine Monitor（VMM，虚拟机监视器）

**三个要求**：

1. 为程序提供与原始硬件及其基本一致的环境
2. 运行在该虚拟硬件环境中的程序性能损失应该较低
3. 系统资源应该处于 VMM 的完全控制之中

![硬件虚拟化](https://img-bed-1309306776.cos.ap-shanghai.myqcloud.com/img/20220928145154.png)

#### 优势

* 封装性：
  * 以虚拟机为粒度的封装使得虚拟机运行环境的保存非常便捷
    * 虚拟机快照（某个时间点的状态抓取下来并保存）
    * 虚拟机克隆（从一个虚拟机的执行环境复制出一个或多个相同的虚拟机）
    * 虚拟机挂起和恢复（暂停一个运行中的虚拟机，将其运行环境保存在磁盘上；将保存在磁盘上的虚拟机运行环境恢复到内存中）
  * 使得保存、部署更加方便，从而使得软件开发、测试和调试更加便捷；降低IT管理和维护成本
* 多实例：提高计算机性能利用率，降低计算机资源消耗
  * 不同的服务器有不同的繁忙和空闲时段，将多个物理服务器合并到少数服务器上以虚拟机运行，使用更少的服务器获得同样的整体性能，通过虚拟机的忙闲交错大大提高资源利用率；节约物理资源、人力资源、软件资源成本。
* 隔离：虚拟机中的应用程序可以在自己的操作系统中独立地运行，不影响其他工作负载
  * 提高安全性：适用于测试场景；适合作为安全软件公司的蜜罐
* 硬件无关性
  * 屏蔽硬件差异，无缝跨硬件迁移；云计算环境中虚拟机迁移是非常重要的；【复现老旧硬件接口】
* 特权功能
  * 在虚拟化层添加特权功能的优点：不能被客户机绕过、更容易实现
  * 事件记录和回放——入侵检测、病毒检测等

### 操作系统级虚拟化

### Docker

## 云数据中心的虚拟化

### 服务器

### 存储

### 网络-软件定义网络

## 虚拟机存储